import{a as D}from"./chunk-ZMMKKJQJ.js";import"./chunk-EE6HZFYN.js";import{a as z}from"./chunk-ZUTIRBQC.js";import{F as v,G as a,Ha as V,L as k,S as g,T as _,W as S,X as w,aa as n,ba as i,ca as m,da as P,ea as O,ga as u,ha as d,na as E,oa as r,pa as f,q as M,qa as y,r as x,ra as T,s as b,t as s,u as p,xa as A,y as C}from"./chunk-3SYP3RR3.js";import"./chunk-2NFLSA4Y.js";var H=(e,o)=>o.name;function I(e,o){if(e&1){let t=P();n(0,"div",5),s(),n(1,"svg",3),m(2,"path",10),i(),p(),n(3,"span"),r(4),i(),n(5,"button",11),u("click",function(){x(t);let l=d();return b(l.error.set(null))}),r(6,"\xD7"),i()()}if(e&2){let t=d();a(4),f(t.error())}}function j(e,o){if(e&1){let t=P();n(0,"div",6),s(),n(1,"svg",3),m(2,"path",12),i(),p(),n(3,"span"),r(4),i(),n(5,"button",11),u("click",function(){x(t);let l=d();return b(l.successMessage.set(null))}),r(6,"\xD7"),i()()}if(e&2){let t=d();a(4),f(t.successMessage())}}function N(e,o){e&1&&(n(0,"div",9),m(1,"div",13),n(2,"p"),r(3,"Cargando citas..."),i()())}function G(e,o){if(e&1&&(n(0,"div",24),s(),n(1,"svg",3),m(2,"path",27),i(),p(),n(3,"div",28)(4,"span",29),r(5,"Contexto:"),i(),n(6,"p"),r(7),i()()()),e&2){let t=d().$implicit;a(7),f(t.appointment_context)}}function U(e,o){if(e&1&&(n(0,"div",25)(1,"a",30),s(),n(2,"svg",3),m(3,"path",31),i(),r(4," Unirse a la reuni\xF3n "),i()()),e&2){let t=d().$implicit;a(),O("href",t.meeting_url,v)}}function F(e,o){if(e&1){let t=P();n(0,"button",32),u("click",function(){x(t);let l=d().$implicit,h=d(3);return b(h.cancelAppointment(l))}),r(1," Cancelar Cita "),i()}if(e&2){let t=d(4);O("disabled",t.loading())}}function $(e,o){if(e&1&&(n(0,"div",17)(1,"div",18)(2,"div",19),s(),n(3,"svg",3),m(4,"path",20),i(),p(),n(5,"span"),r(6),i()(),n(7,"span",21),r(8),i()(),n(9,"div",22),s(),n(10,"svg",3),m(11,"path",23),i(),p(),n(12,"span"),r(13),i()(),g(14,G,8,1,"div",24),g(15,U,5,1,"div",25),g(16,F,2,1,"button",26),i()),e&2){let t=o.$implicit,c=d(3);E(c.getStatusClass(t.status)),a(6),f(c.formatDate(t.start_datetime)),a(),E(c.getStatusClass(t.status)),a(),y(" ",t.status," "),a(5),T("",c.formatTime(t.start_datetime)," - ",c.formatTime(t.end_datetime)),a(),_(t.appointment_context?14:-1),a(),_(t.meeting_url?15:-1),a(),_(t.status==="Confirmed"||t.status==="Draft"?16:-1)}}function B(e,o){if(e&1&&(n(0,"div",14),S(1,$,17,11,"div",16,H),i()),e&2){let t=d(2);a(),w(t.userAppointments())}}function Y(e,o){e&1&&(n(0,"div",15),s(),n(1,"svg",3),m(2,"path",20),i(),p(),n(3,"p"),r(4,"No tienes citas agendadas"),i()())}function R(e,o){if(e&1&&g(0,B,3,0,"div",14)(1,Y,5,0,"div",15),e&2){let t=d();_(t.userAppointments().length>0?0:1)}}var L=class e{meetSchedulingService=M(D);stateService=M(z);router=M(V);loading=C(!1);error=C(null);successMessage=C(null);userAppointments=C([]);currentUser=this.stateService.currentUser;userContact=this.stateService.userContact;selectedPortal=this.stateService.selectedPortal;ngOnInit(){this.loadUserAppointments()}loadUserAppointments(){let o=this.userContact();if(!o?.name){this.error.set("No se pudo obtener informaci\xF3n del contacto");return}this.loading.set(!0),this.error.set(null),this.meetSchedulingService.getUserAppointments(o.name).subscribe({next:t=>{let c=t.sort((l,h)=>new Date(h.start_datetime).getTime()-new Date(l.start_datetime).getTime());this.userAppointments.set(c),this.loading.set(!1)},error:t=>{console.error("Error loading appointments:",t),this.error.set("Error al cargar las citas"),this.loading.set(!1)}})}cancelAppointment(o){o.name&&confirm("\xBFEst\xE1s seguro de cancelar esta cita?")&&(this.loading.set(!0),this.error.set(null),this.meetSchedulingService.cancelAppointment(o.name).subscribe({next:t=>{this.successMessage.set(t.message||"Cita cancelada exitosamente"),this.loadUserAppointments(),this.loading.set(!1)},error:t=>{console.error("Error canceling appointment:",t),this.error.set("Error al cancelar la cita"),this.loading.set(!1)}}))}formatTime(o){return new Date(o).toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"})}formatDate(o){return new Date(o).toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}getStatusClass(o){switch(o){case"Confirmed":return"status-confirmed";case"Completed":return"status-completed";case"Cancelled":return"status-cancelled";case"No-show":return"status-noshow";default:return"status-draft"}}goBack(){let o=this.selectedPortal();o&&this.router.navigate(["/portal",o.name])}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=k({type:e,selectors:[["app-my-appointments-tool"]],decls:14,vars:3,consts:[[1,"my-appointments-tool"],[1,"tool-header"],[1,"btn-back",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"alert","alert-error"],[1,"alert","alert-success"],[1,"appointments-container"],[1,"section-card"],[1,"loading-state"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"close-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"spinner"],[1,"appointments-list"],[1,"no-appointments"],[1,"appointment-card",3,"class"],[1,"appointment-card"],[1,"appointment-header"],[1,"appointment-date"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"status-badge"],[1,"appointment-time"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"appointment-context"],[1,"appointment-link"],[1,"btn-cancel",3,"disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],[1,"context-content"],[1,"context-label"],["target","_blank","rel","noopener noreferrer",3,"href"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"btn-cancel",3,"click","disabled"]],template:function(t,c){t&1&&(n(0,"div",0)(1,"div",1)(2,"button",2),u("click",function(){return c.goBack()}),s(),n(3,"svg",3),m(4,"path",4),i(),r(5," Volver "),i(),p(),n(6,"h1"),r(7,"Mis Citas"),i()(),g(8,I,7,1,"div",5),g(9,j,7,1,"div",6),n(10,"div",7)(11,"div",8),g(12,N,4,0,"div",9)(13,R,2,1),i()()()),t&2&&(a(8),_(c.error()?8:-1),a(),_(c.successMessage()?9:-1),a(3),_(c.loading()?12:13))},dependencies:[A],styles:[".my-appointments-tool[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;padding:2rem}.tool-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-bottom:2rem}.tool-header[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:#fff;border:1px solid #e2e8f0;border-radius:.5rem;color:#4a5568;font-size:.9rem;font-weight:500;cursor:pointer;transition:all .2s}.tool-header[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}.tool-header[_ngcontent-%COMP%]   .btn-back[_ngcontent-%COMP%]:hover{background:#f7fafc;border-color:#cbd5e0}.tool-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#1a202c;margin:0}.alert[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-radius:.5rem;display:flex;align-items:center;gap:.75rem;margin-bottom:1.5rem;position:relative}.alert[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;flex-shrink:0}.alert[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1}.alert[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;opacity:.6;transition:opacity .2s;padding:0;line-height:1}.alert[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{opacity:1}.alert-error[_ngcontent-%COMP%]{background:#fff5f5;color:#c53030;border:1px solid #feb2b2}.alert-success[_ngcontent-%COMP%]{background:#f0fff4;color:#2f855a;border:1px solid #9ae6b4}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:4rem 2rem}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid rgba(102,126,234,.2);border-top-color:#667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1.5rem}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#718096;font-size:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.appointments-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto}.section-card[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;padding:2rem;box-shadow:0 2px 8px #00000014}.appointments-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.appointment-card[_ngcontent-%COMP%]{padding:1.5rem;border:2px solid #e2e8f0;border-radius:.75rem;transition:all .2s}.appointment-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a;transform:translateY(-2px)}.appointment-card.status-confirmed[_ngcontent-%COMP%]{border-color:#9ae6b4;background:#f0fff4}.appointment-card.status-completed[_ngcontent-%COMP%]{border-color:#cbd5e0;background:#f7fafc}.appointment-card.status-cancelled[_ngcontent-%COMP%]{border-color:#feb2b2;background:#fff5f5}.appointment-card.status-draft[_ngcontent-%COMP%]{border-color:#fbd38d;background:#fffaf0}.appointment-card[_ngcontent-%COMP%]   .appointment-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem}.appointment-card[_ngcontent-%COMP%]   .appointment-date[_ngcontent-%COMP%], .appointment-card[_ngcontent-%COMP%]   .appointment-time[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:#2d3748;font-size:.95rem}.appointment-card[_ngcontent-%COMP%]   .appointment-date[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%], .appointment-card[_ngcontent-%COMP%]   .appointment-time[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;color:#718096}.appointment-card[_ngcontent-%COMP%]   .appointment-time[_ngcontent-%COMP%]{margin-bottom:1rem}.appointment-card[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:9999px;font-size:.85rem;font-weight:600}.appointment-card[_ngcontent-%COMP%]   .status-badge.status-confirmed[_ngcontent-%COMP%]{background:#9ae6b4;color:#22543d}.appointment-card[_ngcontent-%COMP%]   .status-badge.status-completed[_ngcontent-%COMP%]{background:#cbd5e0;color:#2d3748}.appointment-card[_ngcontent-%COMP%]   .status-badge.status-cancelled[_ngcontent-%COMP%]{background:#feb2b2;color:#742a2a}.appointment-card[_ngcontent-%COMP%]   .status-badge.status-draft[_ngcontent-%COMP%]{background:#fbd38d;color:#744210}.appointment-card[_ngcontent-%COMP%]   .status-badge.status-noshow[_ngcontent-%COMP%]{background:#fc8181;color:#742a2a}.appointment-card[_ngcontent-%COMP%]   .appointment-context[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem;padding:1rem;background:#fff;border:1px solid #e2e8f0;border-radius:.5rem;margin-bottom:1rem}.appointment-card[_ngcontent-%COMP%]   .appointment-context[_ngcontent-%COMP%] > svg[_ngcontent-%COMP%]{width:20px;height:20px;color:#667eea;flex-shrink:0;margin-top:2px}.appointment-card[_ngcontent-%COMP%]   .appointment-context[_ngcontent-%COMP%]   .context-content[_ngcontent-%COMP%]{flex:1}.appointment-card[_ngcontent-%COMP%]   .appointment-context[_ngcontent-%COMP%]   .context-content[_ngcontent-%COMP%]   .context-label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:#4a5568;display:block;margin-bottom:.25rem}.appointment-card[_ngcontent-%COMP%]   .appointment-context[_ngcontent-%COMP%]   .context-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.95rem;color:#2d3748;line-height:1.6;margin:0;white-space:pre-wrap}.appointment-card[_ngcontent-%COMP%]   .appointment-link[_ngcontent-%COMP%]{margin:.75rem 0}.appointment-card[_ngcontent-%COMP%]   .appointment-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.25rem;background:#667eea;color:#fff;text-decoration:none;border-radius:.5rem;font-size:.95rem;font-weight:500;transition:all .2s}.appointment-card[_ngcontent-%COMP%]   .appointment-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px}.appointment-card[_ngcontent-%COMP%]   .appointment-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:#5568d3;transform:translateY(-1px);box-shadow:0 4px 12px #667eea4d}.appointment-card[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]{width:100%;padding:.75rem;background:#fff;border:2px solid #feb2b2;border-radius:.5rem;color:#c53030;font-size:.9rem;font-weight:600;cursor:pointer;transition:all .2s;margin-top:.75rem}.appointment-card[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:hover:not(:disabled){background:#fff5f5;border-color:#fc8181}.appointment-card[_ngcontent-%COMP%]   .btn-cancel[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.no-appointments[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:4rem 2rem;text-align:center}.no-appointments[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:80px;height:80px;color:#cbd5e0;margin-bottom:1.5rem}.no-appointments[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#718096;font-size:1.125rem;margin:0}@media(max-width:768px){.my-appointments-tool[_ngcontent-%COMP%]{padding:1.5rem}.tool-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.75rem}.tool-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.section-card[_ngcontent-%COMP%]{padding:1.5rem}.appointment-card[_ngcontent-%COMP%]{padding:1.25rem}.appointment-card[_ngcontent-%COMP%]   .appointment-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.75rem}}@media(max-width:480px){.my-appointments-tool[_ngcontent-%COMP%]{padding:1rem}.tool-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.25rem}.section-card[_ngcontent-%COMP%], .appointment-card[_ngcontent-%COMP%]{padding:1rem}}"]})};export{L as MyAppointmentsToolComponent};
