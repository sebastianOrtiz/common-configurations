import{a as s}from"./chunk-LXGGI7CL.js";import{e as a,q as l,t as n}from"./chunk-T6CG4JNB.js";var f="/api/method/common_configurations.api",d=class o{constructor(e){this.frappeApi=e}getPortal(e){return this.frappeApi.getDoc("Service Portal",e).pipe(a(t=>{if(!t.success||!t.data)throw new Error(t.error||"Failed to load portal");return t.data}))}getActivePortals(){return this.frappeApi.getList("Service Portal",[["is_active","=",1]],["name","portal_name","title","description","logo","primary_color"],0,50).pipe(a(e=>{if(!e.success||!e.data)throw new Error(e.error||"Failed to load portals");return e.data}))}createUserContact(e){return this.frappeApi.createDoc("User Contact",e).pipe(a(t=>{if(!t.success||!t.data)throw new Error(t.error||"Failed to create user contact");return t.data}))}updateUserContact(e,t){return this.frappeApi.updateDoc("User Contact",e,t).pipe(a(r=>{if(!r.success||!r.data)throw new Error(r.error||"Failed to update user contact");return r.data}))}getUserContactByEmail(e){return this.frappeApi.getList("User Contact",[["email","=",e]],["*"],0,1).pipe(a(t=>!t.success||!t.data||t.data.length===0?null:t.data[0]))}getUserContactByDocument(e){return this.frappeApi.getList("User Contact",[["document","=",e]],["*"],0,1).pipe(a(t=>!t.success||!t.data||t.data.length===0?null:t.data[0]))}getToolTypes(){return this.frappeApi.getList("Tool Type",[["is_active","=",1]],["*"],0,100).pipe(a(e=>{if(!e.success||!e.data)throw new Error(e.error||"Failed to load tool types");return e.data}))}callPortalMethod(e,t){return this.frappeApi.callMethod(`${f}.portal_api.${e}`,t).pipe(a(r=>{if(!r.success&&r.message===void 0)throw new Error(r.error||"API call failed");return r.message}))}getUserContactFields(){return this.frappeApi.getDocTypeMeta("User Contact").pipe(a(e=>{if(!e.success||!e.message||!e.message.docs)throw new Error("Failed to load User Contact metadata");let t=e.message.docs[0];return(t.fields||[]).filter(i=>!(i.hidden||i.read_only||!["Data","Select","Int","Float","Currency","Date","Datetime","Time","Check","Text","Small Text","Long Text","Link","Dynamic Link","Phone","Email"].includes(i.fieldtype))).sort((i,c)=>{let p=t.field_order?.indexOf(i.fieldname)??999,u=t.field_order?.indexOf(c.fieldname)??999;return p-u})}))}static \u0275fac=function(t){return new(t||o)(n(s))};static \u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"})};export{d as a};
