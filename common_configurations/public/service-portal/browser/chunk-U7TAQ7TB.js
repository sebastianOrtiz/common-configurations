import{a as F}from"./chunk-E7DMPH65.js";import{b as V,c as R,d as T,e as D,f as z,g as U,k as I,l as j}from"./chunk-O3KMISTK.js";import"./chunk-6QOS2Z35.js";import{$ as m,F as f,Ga as N,Ia as k,Ka as E,L as s,P as v,X as O,Y as h,aa as t,ba as n,ca as C,ga as y,ia as u,ka as x,la as S,pa as l,qa as b,u as _,w as d,x as p,y as M,z as P,za as w}from"./chunk-T73TVVXL.js";import"./chunk-2NFLSA4Y.js";function Y(c,o){if(c&1&&(t(0,"div",8),M(),t(1,"svg",5),C(2,"path",23),n(),P(),t(3,"span"),l(4),n()()),c&2){let r=x();s(4),b(r.error())}}function A(c,o){c&1&&(C(0,"span",24),l(1," Registrando... "))}function G(c,o){c&1&&l(0," Continuar ")}var q=class c{route=_(N);router=_(k);portalService=_(F);stateService=_(E);firstName=f("");lastName=f("");phone=f("");company=f("");loading=f(!1);error=f(null);currentUser=this.stateService.currentUser;selectedPortal=this.stateService.selectedPortal;ngOnInit(){if(this.stateService.userContact()){let r=this.route.snapshot.paramMap.get("portalName");r&&this.router.navigate(["/portal",r])}let o=this.currentUser();if(o&&o.full_name){let r=o.full_name.split(" ");r.length>=2?(this.firstName.set(r[0]),this.lastName.set(r.slice(1).join(" "))):this.firstName.set(o.full_name)}}onSubmit(){this.error.set(null);let o=this.firstName().trim(),r=this.lastName().trim();if(!o||!r){this.error.set("Por favor completa tu nombre y apellido");return}let e=this.currentUser(),a=this.selectedPortal();if(!e||!a){this.error.set("Error de sesi\xF3n. Por favor intenta de nuevo.");return}this.loading.set(!0);let g={email:e.email,first_name:o,last_name:r,phone:this.phone().trim()||void 0,company:this.company().trim()||void 0};this.portalService.createUserContact(g).subscribe({next:i=>{this.stateService.setUserContact(i),this.loading.set(!1),this.router.navigate(["/portal",a.name])},error:i=>{console.error("Error creating contact:",i),this.error.set("Error al registrar tu informaci\xF3n. Por favor intenta de nuevo."),this.loading.set(!1)}})}skip(){let o=this.selectedPortal();o&&!o.request_contact_user_data&&this.router.navigate(["/portal",o.name])}cancel(){this.router.navigate(["/portals"])}static \u0275fac=function(r){return new(r||c)};static \u0275cmp=v({type:c,selectors:[["app-contact-registration"]],decls:39,vars:14,consts:[["regForm","ngForm"],[1,"registration-container"],[1,"registration-card"],[1,"registration-header"],[1,"icon"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"registration-form",3,"ngSubmit"],[1,"alert","alert-error"],[1,"form-group"],["for","firstName"],["type","text","id","firstName","name","firstName","placeholder","Tu nombre","required","",3,"ngModelChange","ngModel","disabled"],["for","lastName"],["type","text","id","lastName","name","lastName","placeholder","Tu apellido","required","",3,"ngModelChange","ngModel","disabled"],["for","email"],["type","email","id","email","name","email","readonly","","disabled","",3,"value"],["for","phone"],["type","tel","id","phone","name","phone","placeholder","+1234567890",3,"ngModelChange","ngModel","disabled"],["for","company"],["type","text","id","company","name","company","placeholder","Nombre de tu empresa",3,"ngModelChange","ngModel","disabled"],[1,"form-actions"],["type","button",1,"btn-secondary",3,"click","disabled"],["type","submit",1,"btn-primary",3,"disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"spinner"]],template:function(r,e){if(r&1){let a=y();t(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4),M(),t(4,"svg",5),C(5,"path",6),n()(),P(),t(6,"h1"),l(7),n(),t(8,"p"),l(9,"Por favor proporciona la siguiente informaci\xF3n para continuar"),n()(),t(10,"form",7,0),u("ngSubmit",function(){return d(a),p(e.onSubmit())}),O(12,Y,5,1,"div",8),t(13,"div",9)(14,"label",10),l(15," Nombre * "),n(),t(16,"input",11),u("ngModelChange",function(i){return d(a),p(e.firstName.set(i))}),n()(),t(17,"div",9)(18,"label",12),l(19," Apellido * "),n(),t(20,"input",13),u("ngModelChange",function(i){return d(a),p(e.lastName.set(i))}),n()(),t(21,"div",9)(22,"label",14),l(23," Email "),n(),C(24,"input",15),n(),t(25,"div",9)(26,"label",16),l(27," Tel\xE9fono "),n(),t(28,"input",17),u("ngModelChange",function(i){return d(a),p(e.phone.set(i))}),n()(),t(29,"div",9)(30,"label",18),l(31," Empresa "),n(),t(32,"input",19),u("ngModelChange",function(i){return d(a),p(e.company.set(i))}),n()(),t(33,"div",20)(34,"button",21),u("click",function(){return d(a),p(e.cancel())}),l(35," Cancelar "),n(),t(36,"button",22),O(37,A,2,0)(38,G,1,0),n()()()()()}if(r&2){let a,g,i=S(11);s(7),b(((a=e.selectedPortal())==null?null:a.registration_title)||"Completa tu Perfil"),s(5),h(e.error()?12:-1),s(4),m("ngModel",e.firstName())("disabled",e.loading()),s(4),m("ngModel",e.lastName())("disabled",e.loading()),s(4),m("value",((g=e.currentUser())==null?null:g.email)||""),s(4),m("ngModel",e.phone())("disabled",e.loading()),s(4),m("ngModel",e.company())("disabled",e.loading()),s(2),m("disabled",e.loading()),s(2),m("disabled",e.loading()||!i.form.valid),s(),h(e.loading()?37:38)}},dependencies:[w,j,U,V,R,T,I,z,D],styles:[".registration-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);padding:2rem}.registration-card[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;box-shadow:0 20px 60px #0000004d;max-width:500px;width:100%;padding:2.5rem;animation:_ngcontent-%COMP%_slideIn .4s ease-out}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.registration-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.registration-header[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{width:64px;height:64px;margin:0 auto 1rem;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:1rem;display:flex;align-items:center;justify-content:center}.registration-header[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:40px;height:40px;color:#fff}.registration-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#1a202c;margin:0 0 .5rem}.registration-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#718096;font-size:.95rem;margin:0}.registration-form[_ngcontent-%COMP%]   .alert[_ngcontent-%COMP%]{padding:1rem;border-radius:.5rem;display:flex;align-items:center;gap:.75rem;margin-bottom:1.5rem}.registration-form[_ngcontent-%COMP%]   .alert[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px;flex-shrink:0}.registration-form[_ngcontent-%COMP%]   .alert-error[_ngcontent-%COMP%]{background:#fff5f5;color:#c53030;border:1px solid #feb2b2}.registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:600;color:#2d3748;margin-bottom:.5rem;font-size:.9rem}.registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=tel][_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;border:2px solid #e2e8f0;border-radius:.5rem;font-size:1rem;transition:all .2s;box-sizing:border-box}.registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus, .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]:focus, .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=tel][_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:disabled, .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][readonly][_ngcontent-%COMP%], .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]:disabled, .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][readonly][_ngcontent-%COMP%], .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=tel][_ngcontent-%COMP%]:disabled, .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=tel][readonly][_ngcontent-%COMP%]{background:#f7fafc;cursor:not-allowed;opacity:.6}.registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]::placeholder, .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]::placeholder, .registration-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=tel][_ngcontent-%COMP%]::placeholder{color:#cbd5e0}.registration-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:2rem}.registration-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.875rem;border:none;border-radius:.5rem;font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center;gap:.5rem}.registration-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.registration-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#edf2f7;color:#2d3748}.registration-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#e2e8f0}.registration-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.registration-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 10px 20px #667eea4d}.registration-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.registration-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media(max-width:480px){.registration-container[_ngcontent-%COMP%]{padding:1rem}.registration-card[_ngcontent-%COMP%]{padding:1.5rem}.registration-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.registration-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{flex-direction:column}}"]})};export{q as ContactRegistrationComponent};
