import{a as s}from"./chunk-LXGGI7CL.js";import{e as a,q as l,t as n}from"./chunk-T6CG4JNB.js";var f="/api/method/common_configurations.api",d=class o{constructor(t){this.frappeApi=t}getPortal(t){return this.frappeApi.getDoc("Service Portal",t).pipe(a(e=>{if(!e.success||!e.data)throw new Error(e.error||"Failed to load portal");return e.data}))}getActivePortals(){return this.frappeApi.getList("Service Portal",[["is_active","=",1]],["name","portal_name","title","description","logo","primary_color"],0,50).pipe(a(t=>{if(!t.success||!t.data)throw new Error(t.error||"Failed to load portals");return t.data}))}createUserContact(t){return this.frappeApi.createDoc("User Contact",t).pipe(a(e=>{if(!e.success||!e.data)throw new Error(e.error||"Failed to create user contact");return e.data}))}updateUserContact(t,e){return this.frappeApi.updateDoc("User Contact",t,e).pipe(a(r=>{if(!r.success||!r.data)throw new Error(r.error||"Failed to update user contact");return r.data}))}getUserContactByEmail(t){return this.frappeApi.getList("User Contact",[["email","=",t]],["*"],0,1).pipe(a(e=>!e.success||!e.data||e.data.length===0?null:e.data[0]))}getToolTypes(){return this.frappeApi.getList("Tool Type",[["is_active","=",1]],["*"],0,100).pipe(a(t=>{if(!t.success||!t.data)throw new Error(t.error||"Failed to load tool types");return t.data}))}callPortalMethod(t,e){return this.frappeApi.callMethod(`${f}.portal_api.${t}`,e).pipe(a(r=>{if(!r.success&&r.message===void 0)throw new Error(r.error||"API call failed");return r.message}))}getUserContactFields(){return this.frappeApi.getDocTypeMeta("User Contact").pipe(a(t=>{if(!t.success||!t.message||!t.message.docs)throw new Error("Failed to load User Contact metadata");let e=t.message.docs[0];return(e.fields||[]).filter(i=>!(i.hidden||i.read_only||!["Data","Select","Int","Float","Currency","Date","Datetime","Time","Check","Text","Small Text","Long Text","Link","Dynamic Link","Phone","Email"].includes(i.fieldtype))).sort((i,c)=>{let p=e.field_order?.indexOf(i.fieldname)??999,u=e.field_order?.indexOf(c.fieldname)??999;return p-u})}))}static \u0275fac=function(e){return new(e||o)(n(s))};static \u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"})};export{d as a};
