import{a as z}from"./chunk-EJJQBBQI.js";import{a as Z}from"./chunk-TIMYVRBQ.js";import{A as N,Ba as x,D as F,E as _,Fa as V,Ga as B,Ia as G,Ja as H,Ka as K,P as U,U as j,V as O,a as E,b as y,da as W,e as c,g as u,h as M,j as l,l as v,n as h,o as I,q as b,s as k,t as f,u as a,v as P,wa as L}from"./chunk-T6CG4JNB.js";import{a as A}from"./chunk-2NFLSA4Y.js";var T=class e{constructor(o,r){this.authService=o;this.router=r}canActivate(){return this.authService.checkAuthStatus().pipe(l(1),c(o=>o?!0:(this.router.navigate(["/login"]),!1)))}static \u0275fac=function(r){return new(r||e)(f(z),f(H))};static \u0275prov=b({token:e,factory:e.\u0275fac,providedIn:"root"})},D=()=>a(T).canActivate();var Y=[{path:"",redirectTo:"/portals",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-UZM6BK4B.js").then(e=>e.LoginComponent)},{path:"portals",canActivate:[D],loadComponent:()=>import("./chunk-AK3657DS.js").then(e=>e.PortalSelectorComponent)},{path:"portal/:portalName",canActivate:[D],children:[{path:"",loadComponent:()=>import("./chunk-QHXNSDNR.js").then(e=>e.PortalViewComponent)},{path:"register",loadComponent:()=>import("./chunk-NWRN7USN.js").then(e=>e.ContactRegistrationComponent)},{path:"tool/:toolType",loadChildren:()=>import("./chunk-PXOPBBKQ.js").then(e=>e.toolRoutes)}]},{path:"**",redirectTo:"/portals"}];var R="Service workers are disabled or not supported by this browser",g=class{serviceWorker;worker;registration;events;constructor(o,r){if(this.serviceWorker=o,!o)this.worker=this.events=this.registration=new E(n=>n.error(new h(5601,!1)));else{let n=null,t=new y;this.worker=new E(p=>(n!==null&&p.next(n),t.subscribe(C=>p.next(C))));let s=()=>{let{controller:p}=o;p!==null&&(n=p,t.next(n))};o.addEventListener("controllerchange",s),s(),this.registration=this.worker.pipe(v(()=>o.getRegistration().then(p=>{if(!p)throw new h(5601,!1);return p})));let i=new y;this.events=i.asObservable();let d=p=>{let{data:C}=p;C?.type&&i.next(C)};o.addEventListener("message",d),r?.get(O,null,{optional:!0})?.onDestroy(()=>{o.removeEventListener("controllerchange",s),o.removeEventListener("message",d)})}}postMessage(o,r){return new Promise(n=>{this.worker.pipe(l(1)).subscribe(t=>{t.postMessage(A({action:o},r)),n()})})}postMessageWithOperation(o,r,n){let t=this.waitForOperationCompleted(n),s=this.postMessage(o,r);return Promise.all([s,t]).then(([,i])=>i)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(o){let r;return typeof o=="string"?r=n=>n.type===o:r=n=>o.includes(n.type),this.events.pipe(M(r))}nextEventOfType(o){return this.eventsOfType(o).pipe(l(1))}waitForOperationCompleted(o){return new Promise((r,n)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(M(t=>t.nonce===o),l(1),c(t=>{if(t.result!==void 0)return t.result;throw new Error(t.error)})).subscribe({next:r,error:n})})}get isEnabled(){return!!this.serviceWorker}},ee=(()=>{class e{sw;messages;notificationClicks;notificationCloses;pushSubscriptionChanges;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new y;constructor(r){if(this.sw=r,!r.isEnabled){this.messages=u,this.notificationClicks=u,this.notificationCloses=u,this.pushSubscriptionChanges=u,this.subscription=u;return}this.messages=this.sw.eventsOfType("PUSH").pipe(c(t=>t.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(c(t=>t.data)),this.notificationCloses=this.sw.eventsOfType("NOTIFICATION_CLOSE").pipe(c(t=>t.data)),this.pushSubscriptionChanges=this.sw.eventsOfType("PUSH_SUBSCRIPTION_CHANGE").pipe(c(t=>t.data)),this.pushManager=this.sw.registration.pipe(c(t=>t.pushManager));let n=this.pushManager.pipe(v(t=>t.getSubscription()));this.subscription=new E(t=>{let s=n.subscribe(t),i=this.subscriptionChanges.subscribe(t);return()=>{s.unsubscribe(),i.unsubscribe()}})}requestSubscription(r){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(R));let n={userVisibleOnly:!0},t=this.decodeBase64(r.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(t.length));for(let i=0;i<t.length;i++)s[i]=t.charCodeAt(i);return n.applicationServerKey=s,new Promise((i,d)=>{this.pushManager.pipe(v(m=>m.subscribe(n)),l(1)).subscribe({next:m=>{this.subscriptionChanges.next(m),i(m)},error:d})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(R));let r=n=>{if(n===null)throw new h(5602,!1);return n.unsubscribe().then(t=>{if(!t)throw new h(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((n,t)=>{this.subscription.pipe(l(1),v(r)).subscribe({next:n,error:t})})}decodeBase64(r){return atob(r)}static \u0275fac=function(n){return new(n||e)(f(g))};static \u0275prov=b({token:e,factory:e.\u0275fac})}return e})(),te=(()=>{class e{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}ongoingCheckForUpdate=null;constructor(r){if(this.sw=r,!r.isEnabled){this.versionUpdates=u,this.unrecoverable=u;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(R));if(this.ongoingCheckForUpdate)return this.ongoingCheckForUpdate;let r=this.sw.generateNonce();return this.ongoingCheckForUpdate=this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:r},r).finally(()=>{this.ongoingCheckForUpdate=null}),this.ongoingCheckForUpdate}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new h(5601,!1));let r=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:r},r)}static \u0275fac=function(n){return new(n||e)(f(g))};static \u0275prov=b({token:e,factory:e.\u0275fac})}return e})(),J=new k("");function re(){let e=a(w);if(!("serviceWorker"in navigator&&e.enabled!==!1))return;let o=a(J),r=a(F),n=a(O);r.runOutsideAngular(()=>{let t=navigator.serviceWorker,s=()=>t.controller?.postMessage({action:"INITIALIZE"});t.addEventListener("controllerchange",s),n.onDestroy(()=>{t.removeEventListener("controllerchange",s)})}),r.runOutsideAngular(()=>{let t,{registrationStrategy:s}=e;if(typeof s=="function")t=new Promise(i=>s().subscribe(()=>i()));else{let[i,...d]=(s||"registerWhenStable:30000").split(":");switch(i){case"registerImmediately":t=Promise.resolve();break;case"registerWithDelay":t=$(+d[0]||0);break;case"registerWhenStable":t=Promise.race([n.whenStable(),$(+d[0])]);break;default:throw new h(5600,!1)}}t.then(()=>{n.destroyed||navigator.serviceWorker.register(o,{scope:e.scope,updateViaCache:e.updateViaCache,type:e.type}).catch(i=>console.error(I(5604,!1)))})})}function $(e){return new Promise(o=>setTimeout(o,e))}function ne(){let e=a(w),o=a(N),r=!0;return new g(r&&e.enabled!==!1?navigator.serviceWorker:void 0,o)}var w=class{enabled;updateViaCache;type;scope;registrationStrategy};function Q(e,o={}){return P([ee,te,{provide:J,useValue:e},{provide:w,useValue:o},{provide:g,useFactory:ne},j(re)])}var X={providers:[_(),K(Y),V(B()),Q("ngsw-worker.js",{enabled:!L(),registrationStrategy:"registerWhenStable:30000"})]};var S=class e{frappeApi=a(Z);ngOnInit(){this.frappeApi.fetchCsrfToken().subscribe()}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=U({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(r,n){r&1&&W(0,"router-outlet")},dependencies:[G],encapsulation:2})};x(S,X).catch(e=>console.error(e));
